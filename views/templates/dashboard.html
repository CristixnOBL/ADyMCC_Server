{% extends "template.html" %}

{% block head %}
    <title>Dashboard</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style_dashboard.css')}}">
{% endblock %}

{% block body %}
    <div class="">
        <div class="row text-white">
            <div class="col p-2">
                <div class="bg-status p-2 h-100">
                    <svg width="1rem" height="1rem" viewBox="0 0 512 512">
                        <path fill="currentColor" d="M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"/>
                    </svg>
                    <span class="align-middle">Date</span>
                    <hr class="dropdown-divider" style="height: 0.2rem;">
                    <span id="date_label" class="align-middle"></span>
                </div>
            </div>
            <div class="col p-2">
                <div class="bg-status p-2 h-100">
                    <svg width="1rem" height="1rem" viewBox="0 0 384 512">
                        <path fill="currentColor" d="M320 0H128L0 128v320c0 35.3 28.7 64 64 64h256c35.3 0 64-28.7 64-64V64c0-35.3-28.7-64-64-64zM160 160h-48V64h48v96zm80 0h-48V64h48v96zm80 0h-48V64h48v96z"/>
                    </svg>
                    <span class="align-middle">Memory</span>
                    <hr class="dropdown-divider" style="height: 0.2rem;">
                    <span id="memory_label" class="align-middle"></span>
                </div>
            </div>
            <div class="col p-2">
                <div class="bg-status p-2 h-100">
                    <svg width="1rem" height="1rem" viewBox="0 0 256 512">
                        <path fill="currentColor" d="M192 384c0 35.346-28.654 64-64 64-35.346 0-64-28.654-64-64 0-23.685 12.876-44.349 32-55.417V160c0-17.673 14.327-32 32-32s32 14.327 32 32v168.583c19.124 11.068 32 31.732 32 55.417zm32-84.653c19.912 22.563 32 52.194 32 84.653 0 70.696-57.303 128-128 128-.299 0-.609-.001-.909-.003C56.789 511.509-.357 453.636.002 383.333.166 351.135 12.225 321.755 32 299.347V96c0-53.019 42.981-96 96-96s96 42.981 96 96v203.347zM208 384c0-34.339-19.37-52.19-32-66.502V96c0-26.467-21.533-48-48-48S80 69.533 80 96v221.498c-12.732 14.428-31.825 32.1-31.999 66.08-.224 43.876 35.563 80.116 79.423 80.42L128 464c44.112 0 80-35.888 80-80z"/>
                    </svg>
                    <span class="align-middle">Temperature</span>
                    <hr class="dropdown-divider" style="height: 0.2rem;">
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-xl-9 p-2">
                <div class="bg-menu rounded-1">
                    <img src="{{ url_for('static', filename='images/852494.jpg')}}" class="img_stream mx-auto d-block">
                </div>
            </div>
            <div class="col p-2 text-white">
                <div class="bg-menu p-2 rounded-1">
                    <svg width="1rem" height="1rem" viewBox="0 0 640 512">
                        <path fill="currentColor" d="M512.1 191l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0L552 6.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zm-10.5-58.8c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.7-82.4 14.3-52.8 52.8zM386.3 286.1l33.7 16.8c10.1 5.8 14.5 18.1 10.5 29.1-8.9 24.2-26.4 46.4-42.6 65.8-7.4 8.9-20.2 11.1-30.3 5.3l-29.1-16.8c-16 13.7-34.6 24.6-54.9 31.7v33.6c0 11.6-8.3 21.6-19.7 23.6-24.6 4.2-50.4 4.4-75.9 0-11.5-2-20-11.9-20-23.6V418c-20.3-7.2-38.9-18-54.9-31.7L74 403c-10 5.8-22.9 3.6-30.3-5.3-16.2-19.4-33.3-41.6-42.2-65.7-4-10.9.4-23.2 10.5-29.1l33.3-16.8c-3.9-20.9-3.9-42.4 0-63.4L12 205.8c-10.1-5.8-14.6-18.1-10.5-29 8.9-24.2 26-46.4 42.2-65.8 7.4-8.9 20.2-11.1 30.3-5.3l29.1 16.8c16-13.7 34.6-24.6 54.9-31.7V57.1c0-11.5 8.2-21.5 19.6-23.5 24.6-4.2 50.5-4.4 76-.1 11.5 2 20 11.9 20 23.6v33.6c20.3 7.2 38.9 18 54.9 31.7l29.1-16.8c10-5.8 22.9-3.6 30.3 5.3 16.2 19.4 33.2 41.6 42.1 65.8 4 10.9.1 23.2-10 29.1l-33.7 16.8c3.9 21 3.9 42.5 0 63.5zm-117.6 21.1c59.2-77-28.7-164.9-105.7-105.7-59.2 77 28.7 164.9 105.7 105.7zm243.4 182.7l-8.2 14.3c-3 5.3-9.4 7.5-15.1 5.4-11.8-4.4-22.6-10.7-32.1-18.6-4.6-3.8-5.8-10.5-2.8-15.7l8.2-14.3c-6.9-8-12.3-17.3-15.9-27.4h-16.5c-6 0-11.2-4.3-12.2-10.3-2-12-2.1-24.6 0-37.1 1-6 6.2-10.4 12.2-10.4h16.5c3.6-10.1 9-19.4 15.9-27.4l-8.2-14.3c-3-5.2-1.9-11.9 2.8-15.7 9.5-7.9 20.4-14.2 32.1-18.6 5.7-2.1 12.1.1 15.1 5.4l8.2 14.3c10.5-1.9 21.2-1.9 31.7 0l8.2-14.3c3-5.3 9.4-7.5 15.1-5.4 11.8 4.4 22.6 10.7 32.1 18.6 4.6 3.8 5.8 10.5 2.8 15.7l-8.2 14.3c6.9 8 12.3 17.3 15.9 27.4h16.5c6 0 11.2 4.3 12.2 10.3 2 12 2.1 24.6 0 37.1-1 6-6.2 10.4-12.2 10.4h-16.5c-3.6 10.1-9 19.4-15.9 27.4l8.2 14.3c3 5.2 1.9 11.9-2.8 15.7-9.5 7.9-20.4 14.2-32.1 18.6-5.7 2.1-12.1-.1-15.1-5.4l-8.2-14.3c-10.4 1.9-21.2 1.9-31.7 0zM501.6 431c38.5 29.6 82.4-14.3 52.8-52.8-38.5-29.6-82.4 14.3-52.8 52.8z"/>
                    </svg>
                    <span class="align-middle">Microscope control</span>
                    <hr class="dropdown-divider" style="height: 0.2rem;">

                    <div class="row p-2">
                        <div class="col text-center">
                            <span>Small step</span>
                            <div class="buttons_control">
                                <button id="btn_up" class="btn btn-dark btn-dash m-1">
                                    <svg width="2rem" height="2rem" viewBox="0 0 448 512">
                                        <path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/>
                                    </svg>
                                </button>
                                <button id="btn_down" class="btn btn-dark btn-dash m-1">
                                    <svg width="2rem" height="2rem" viewBox="0 0 448 512">
                                        <path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="col text-center">
                            <span>Big step</span>
                            <div class="buttons_control">
                                <button id="btn_up" class="btn btn-dark btn-dash m-1">
                                    <svg width="2rem" height="2rem" viewBox="0 0 448 512">
                                        <path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zm-32 252c0 6.6-5.4 12-12 12h-92v92c0 6.6-5.4 12-12 12h-56c-6.6 0-12-5.4-12-12v-92H92c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h92v-92c0-6.6 5.4-12 12-12h56c6.6 0 12 5.4 12 12v92h92c6.6 0 12 5.4 12 12v56z"/>
                                    </svg>
                                </button>
                                <button id="btn_down" class="btn btn-dark btn-dash m-1">
                                    <svg width="2rem" height="2rem" viewBox="0 0 448 512">
                                        <path fill="currentColor" d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM92 296c-6.6 0-12-5.4-12-12v-56c0-6.6 5.4-12 12-12h264c6.6 0 12 5.4 12 12v56c0 6.6-5.4 12-12 12H92z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <hr class="dropdown-divider" style="height: 0.2rem;">

                    <div class="row p-2">
                        <div class="col text-center">
                            <span>Light on/off</span>
                            <div class="buttons_control">
                                <button id="btn_light" class="btn btn-dark btn-dash m-1">
                                    <svg width="2rem" height="2rem" viewBox="0 0 352 512">
                                        <path fill="currentColor" d="M96.06 454.35c.01 6.29 1.87 12.45 5.36 17.69l17.09 25.69a31.99 31.99 0 0 0 26.64 14.28h61.71a31.99 31.99 0 0 0 26.64-14.28l17.09-25.69a31.989 31.989 0 0 0 5.36-17.69l.04-38.35H96.01l.05 38.35zM0 176c0 44.37 16.45 84.85 43.56 115.78 16.52 18.85 42.36 58.23 52.21 91.45.04.26.07.52.11.78h160.24c.04-.26.07-.51.11-.78 9.85-33.22 35.69-72.6 52.21-91.45C335.55 260.85 352 220.37 352 176 352 78.61 272.91-.3 175.45 0 73.44.31 0 82.97 0 176zm176-80c-44.11 0-80 35.89-80 80 0 8.84-7.16 16-16 16s-16-7.16-16-16c0-61.76 50.24-112 112-112 8.84 0 16 7.16 16 16s-7.16 16-16 16z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-6 p-2 div_screen">
                <div class="bg-menu p-2 h-100 rounded-1">
                    <button id="btn_screen_img">Descargar</button>
                    <button id="btn_record_stop">Record</button>
                </div>
            </div>

        </div>
    </div>

{% endblock %}

{% block js %}
    <script>
        const $btn_screen_img = document.getElementById("btn_screen_img");
        const $btn_record_vid = document.getElementById("btn_record_stop");
        const $memory_label = document.getElementById("memory_label");

        $btn_screen_img.onclick = async () => {
            const request_server = await fetch("./screen_img");
            const response_server = await request_server.json();
            update_memory();
        };

        $btn_record_vid.onclick = async () => {
            const request_server = await fetch("./record");
            const response_server = await request_server.json();
            if (response_server){
                $btn_record_vid.innerHTML = "Stop"
            } else {
                $btn_record_vid.innerHTML = "Record"
                update_memory();
            }
        };

        async function update_memory(){
            const request_server = await fetch("./memory");
            const response_server = await request_server.json();
            $memory_label.innerHTML = response_server
        };

        update_memory();

        const $date_label = document.getElementById("date_label");
        var updt = setInterval(updt_label, 1000);
        function updt_label(){
            var d = new Date();
            var t = d.toLocaleDateString() + " " + d.toLocaleTimeString();
            $date_label.innerHTML = t;
        }
        updt_label();
    </script>
{% endblock %}